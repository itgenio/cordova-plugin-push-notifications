// @ts-nocheck
const fs=require("fs"),path=require("path");function addProjectLevelDependency(e){return new Promise(((n,o)=>{try{const o=`classpath '${"com.google.gms:google-services:4.4.2"}'`,t=path.join(e,"build.gradle");let s=fs.readFileSync(t,"utf8");let r=new RegExp(/\bclasspath\b.*/,"g").exec(s);if(null!==r){if(null!==new RegExp(o.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g").exec(s))console.log(`Dependency ${o} already exist`);else{let e=r.index+r[0].length;s=s.substring(0,e)+"\n\t\t"+o+s.substring(e),fs.writeFileSync(t,s,"utf8"),console.log(`Updated ${t} to include dependency ${o}`)}}else console.error(`Unable to insert dependency ${o}`);n()}catch(e){o(e)}}))}function ensureKotlinVersion(e){return new Promise(((n,o)=>{try{const o=path.join(e,"build.gradle");let t=fs.readFileSync(o,"utf8");const s=/ext\.kotlin_version\s*=\s*['"]([^'"]+)['"]/,r=s.exec(t);if(r){const e=r[1],n="1.9.24";e!==n?(t=t.replace(s,`ext.kotlin_version = '${n}'`),fs.writeFileSync(o,t,"utf8"),console.log(`Updated Kotlin version from ${e} to ${n}`)):console.log(`Kotlin version ${n} already set`)}n()}catch(e){o(e)}}))}module.exports=async e=>{"use strict";const n=path.join(e.opts.projectRoot,"platforms/android");await addProjectLevelDependency(n).catch((e=>{console.error(e.message)})),await ensureKotlinVersion(n).catch((e=>{console.error(e.message)}))};